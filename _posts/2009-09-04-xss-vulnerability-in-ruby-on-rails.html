---
layout: post
title: XSS Vulnerability in Ruby on Rails
categories: []
author: michael
published: true
date: 2009-09-04 05:41:00.000000000 +01:00
---
<p>There is a vulnerability in the escaping code for the form helpers in<br>
Ruby on Rails.  Attackers who can inject deliberately malformed unicode<br>
strings into the form helpers can defeat the escaping checks and inject<br>
arbitrary <span class="caps">HTML</span>.</p>
<pre>
Versions Affected:  2.0.0 and *all* subsequent versions.
Not affected:       Applications running on ruby 1.9
Fixed Versions:     2.3.4, 2.2.3
Candidate CVE:      CVE-2009-3009
</pre>
<h4>Impact</h4>
<p>Due to the way that most databases either don&#8217;t accept or actively<br>
cleanse malformed unicode strings this vulnerability is most likely to<br>
be exploited by non-persistent attacks however persistent attacks may<br>
still be possible in some configurations.</p>
<p><strong>All</strong> users of affected versions are advised to upgrade to a fixed versions.</p>
<h4>Releases</h4>
<p>The 2.3.4 and 2.2.3 releases will be made available shortly and contain fixes for this issue.</p>
<h4>Patches</h4>
<p>In order to provide the fixes for users who are running unsupported<br>
releases, or are unable to upgrade at present we have provided patches<br>
against all affected stable release branches.</p>
<p>The patches are in a format suitable for git-am and consist of two<br>
changesets.  The code for cleansing multi-byte strings, and the<br>
introduction of that code to the relevant helpers.</p>
<ul>
	<li><a href="http://weblog.rubyonrails.org/assets/2009/9/4/2-0-CVE-2009-3009.patch">2-0-<span class="caps">CVE</span>-2009-3009.patch &#8211; Patch for 2.0 series</a></li>
	<li><a href="http://weblog.rubyonrails.org/assets/2009/9/4/2-1-CVE-2009-3009.patch">2-1-<span class="caps">CVE</span>-2009-3009.patch &#8211; Patch for 2.1 series</a></li>
	<li><a href="http://weblog.rubyonrails.org/assets/2009/9/4/2-2-CVE-2009-3009.patch">2-2-<span class="caps">CVE</span>-2009-3009.patch &#8211; Patch for 2.2 series</a></li>
	<li><a href="http://weblog.rubyonrails.org/assets/2009/9/4/2-3-CVE-2009-3009.patch">2-3-<span class="caps">CVE</span>-2009-3009.patch &#8211; Patch for 2.3 series</a></li>
</ul>
<p>Please note that only the  2.2.x and 2.3.x series are supported at<br>
present.  Users of earlier unsupported releases are advised to upgrade<br>
sooner rather than later as we cannot guarantee that future issues will<br>
be backported in this manner.</p>
<h4>Credits</h4>
<p>Thanks to Brian Mastenbrook for reporting the vulnerability to us, and Manfred Stienstra from Fingertips for his work with us on the fix.</p>